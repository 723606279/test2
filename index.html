<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>极简照片画廊 · 纯前端 · GitHub Pages 可部署</title>
  <meta name="description" content="移动优先、零依赖、原生 scroll-snap 滑动画廊。无 3D/滤镜，避免频闪；支持触控、键盘与按钮。" />
  <style>
    :root{
      --bg: #0c0e12;        /* 背景：深色纯色，避免渐变触发重绘 */
      --panel: #0f1117;     /* 画廊面板底色 */
      --text: #e6eaf2;
      --muted:#98a2b3;
      --accent:#7dd3fc;
      --radius: 16px;
      --shadow: 0 10px 40px rgba(0,0,0,.35);
      --max-w: 1080px;      /* 最大宽度 */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font: 15px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }
    .wrap{min-height:100dvh; display:grid; place-items:center; padding: 12px; padding-left: max(12px, env(safe-area-inset-left)); padding-right: max(12px, env(safe-area-inset-right));}

    .gallery{ width: min(100%, var(--max-w)); }

    /* 视口采用原生滚动与 scroll-snap，避免 3D/滤镜导致的频闪 */
    .viewport{ position:relative; width:100%; height: clamp(260px, 68dvh, 720px); background: var(--panel); border-radius: var(--radius); overflow:hidden; box-shadow: var(--shadow); }
    .slides{
      display:flex; height:100%; width:100%;
      overflow-x:auto; overflow-y:hidden;
      scroll-snap-type:x mandatory; scroll-behavior:smooth; -webkit-overflow-scrolling:touch;
      overscroll-behavior-x: contain; /* 防止外层页面跟随位移 */
      touch-action: pan-x; /* 提示只在 X 方向滚动，提高触控跟手性 */
      -ms-overflow-style: none; scrollbar-width: none; /* 隐藏滚动条（Firefox/旧版 Edge） */
    }
    .slides::-webkit-scrollbar{ display:none } /* 隐藏滚动条（WebKit） */

    .slide{ position:relative; flex: 0 0 100%; width:100%; height:100%; scroll-snap-align:center; }
    .slide img{ width:100%; height:100%; object-fit:cover; display:block; background:#000; }
    .cap{
      position:absolute; left:12px; right:12px; bottom:12px;
      background: rgba(0,0,0,.35); color:#fff; padding:8px 10px; border-radius: 12px; font-weight:600;
      backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
    }

    /* 控件：极简圆形箭头 + 点位指示 */
    .ctrl{ display:flex; align-items:center; justify-content:center; gap:10px; margin-top:10px; }

    .arrow{ width:44px; height:44px; border-radius:999px; border:0; cursor:pointer; color:var(--text); background: #171a22; display:grid; place-items:center; box-shadow: 0 1px 0 rgba(255,255,255,.04) inset, 0 6px 16px rgba(0,0,0,.28); }
    .arrow:hover{ background:#1a1f2b }
    .arrow:active{ transform: translateY(1px) }
    .arrow svg{ width:22px; height:22px }

    .dots{ display:flex; gap:8px; align-items:center; padding:6px 10px; background:#111522; border-radius:999px; box-shadow: 0 1px 0 rgba(255,255,255,.04) inset, 0 6px 16px rgba(0,0,0,.28); }
    .dot{ width:8px; height:8px; border-radius:999px; background:#475569; border:0; cursor:pointer }
    .dot[data-active="true"]{ background: linear-gradient(180deg, #60a5fa, var(--accent)); box-shadow: 0 0 10px rgba(125,211,252,.6) }

    /* 小屏：圆角取消，充分利用全屏空间；按钮更大 */
    @media (max-width: 640px){
      .viewport{ height: min(75dvh, 80svh); border-radius: 0 }
      .arrow{ width:48px; height:48px }
      .dots{ padding:8px 12px }
    }

    /* 降低动画以符合无动效偏好 */
    @media (prefers-reduced-motion: reduce){
      .slides{ scroll-behavior:auto }
    }
  </style>
</head>
<body>
  <!--
    部署到 GitHub Pages 的步骤：
    1) 新建一个 GitHub 仓库（Public）。
    2) 将本文件命名为 index.html 放到仓库根目录并 push。
    3) 打开 Settings → Pages，设置 Source 为 main 分支 / (root)。
    4) 几分钟后访问 Pages 域名即可。
  -->
  <div class="wrap">
    <main class="gallery" aria-label="极简照片画廊">
      <div class="viewport" id="viewport">
        <ul class="slides" id="slides" role="list"></ul>
      </div>
      <div class="ctrl">
        <button class="arrow" id="prev" aria-label="上一张">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
        </button>
        <div class="dots" id="dots" aria-label="当前图片位置"></div>
        <button class="arrow" id="next" aria-label="下一张">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
        </button>
      </div>
    </main>
  </div>

  <script>
    // —— 配置你的照片 ——
    const images = [
      { src: "https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1600&auto=format&fit=crop", alt: "抽象霓虹背景", caption: "Neon Abstract" },
      { src: "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1600&auto=format&fit=crop", alt: "雪山与星空", caption: "Milky Way over Peaks" },
      { src: "https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=1600&auto=format&fit=crop", alt: "沙漠公路", caption: "Desert Highway" },
      { src: "https://images.unsplash.com/photo-1491553895911-0055eca6402d?q=80&w=1600&auto=format&fit=crop", alt: "城市夜景", caption: "City Nights" },
      { src: "https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?q=80&w=1600&auto=format&fit=crop", alt: "森林日出", caption: "Forest Sunrise" },
      { src: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=1600&auto=format&fit=crop", alt: "海边悬崖", caption: "Sea Cliffs" }
    ];

    const viewport = document.getElementById('viewport');
    const slidesEl = document.getElementById('slides');
    const dotsEl = document.getElementById('dots');

    // 构建 DOM（原生 scroll-snap，避免任何 3D/滤镜，从根源上解决频闪）
    images.forEach(({src,alt,caption}, i) => {
      const li = document.createElement('li'); li.className = 'slide'; li.setAttribute('role','listitem');
      const img = document.createElement('img');
      img.alt = alt || ''; img.loading = i<2 ? 'eager' : 'lazy'; img.decoding = 'async';
      img.src = src; // 直接使用 src；如需更强的懒加载，可改为 data-src + IO
      li.appendChild(img);
      if (caption) { const cap = document.createElement('div'); cap.className = 'cap'; cap.textContent = caption; li.appendChild(cap); }
      slidesEl.appendChild(li);

      // dots
      const d = document.createElement('button'); d.className='dot'; d.addEventListener('click', () => scrollToIndex(i)); dotsEl.appendChild(d);
    });

    const slides = [...slidesEl.children];

    function indexFromScroll(){
      const w = viewport.clientWidth; if (!w) return 0; return Math.round(viewport.scrollLeft / w);
    }
    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }
    function setActiveDot(i){ [...dotsEl.children].forEach((d, k) => d.setAttribute('data-active', String(k===i))); }
    function scrollToIndex(i){ i = clamp(i, 0, slides.length-1); slides[i].scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'}); }

    // 箭头
    document.getElementById('prev').addEventListener('click', () => scrollToIndex(indexFromScroll() - 1));
    document.getElementById('next').addEventListener('click', () => scrollToIndex(indexFromScroll() + 1));

    // 滚动时更新 dot（节流处理）
    let ticking = false;
    viewport.addEventListener('scroll', () => {
      if (!ticking) {
        window.requestAnimationFrame(() => { setActiveDot(indexFromScroll()); ticking = false; });
        ticking = true;
      }
    }, { passive: true });

    // 键盘支持
    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') scrollToIndex(indexFromScroll()+1);
      else if (e.key === 'ArrowLeft') scrollToIndex(indexFromScroll()-1);
    });

    // 可选自动播放（默认关闭，保持极简）
    const autoplayMs = 0; // 设为 >0 开启，如 4000
    let timer = null;
    function start(){ if (autoplayMs>0 && !timer) timer = setInterval(() => scrollToIndex((indexFromScroll()+1)%slides.length), autoplayMs); }
    function stop(){ if (timer){ clearInterval(timer); timer=null; } }
    viewport.addEventListener('pointerenter', stop);
    viewport.addEventListener('pointerleave', start);

    // 首次激活 dot
    setActiveDot(0); start();

    // 适配：窗口变化时，保持对齐当前页
    let resizeTimer = null;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(() => scrollToIndex(indexFromScroll()), 60);
    });
  </script>
</body>
</html>
